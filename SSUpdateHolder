// THIS SCRIPT IS CURRENTLY DEPRECATED UNTIL
// A PROPER USE CAN BE DETERMINED.

/**
 * Required in OnEquipScript area of shard items. Updates holder
 * information in the database when a shard is equipped.
 * @param integer shard_id An integer value indicating the item.
 * @param boolean flag Used to determine equip or unequip. Not implemented.
 */
function  script  SSUpdateHolder {
    // Function declarations.
    function getShardKey;

    // Data definitions.
    .@shard_id = getarg(0);
    .@shard_key = getShardKey;
    
    // Update the `holder_id` and `holder_name` fields with attached player data.
    query_sql("
        UPDATE `shard`
        SET `holder_id` = "+ getchardid(0) +", `holder_name` = '"+ strcharid(0) +"'
        WHERE `id` = " + .@shard_key
    );
    
    // Success!
    return 0;
    
    // MAIN FUNCTIONS
    // ================================================================================
    /**
     * Checks the attached player's equipment for the
     * parameter shard_id. Determine the equipment slot
     * then return the stored key.
     */
    function getShardKey {
        // Obtain the equip slot.
        if(getequipid(EQI_ACC_L) == .@shard_id)
            .@equip_slot = EQI_ACC_L;
        else
            .@equip_slot = EQI_ACC_R;

        // Return the shard key.
        .@shard_key = (getequipcardid(.@equipSlot, 4) << 16) + getequipcardid(.@equipSlot, 3));
        return .@shard_key;
    }
}
